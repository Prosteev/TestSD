Tue 14 Apr 2020 07:08:25 PM MSK

    создал проект с 0
    выбрал плату ...Discovery

    git init

git add -A
iva@IvaUbuntu:~/prog/ARM/STM/TestSD$ git status
On branch master

No commits yet

Changes to be committed:
  (use "git rm --cached <file>..." to unstage)

    new file:   .cproject
    new file:   .mxproject
    new file:   .project
    new file:   .settings/language.settings.xml
    new file:   Core/Inc/main.h
    new file:   Core/Inc/stm32f3xx_hal_conf.h
    new file:   Core/Inc/stm32f3xx_it.h
    new file:   Core/Src/main.c
    new file:   Core/Src/stm32f3xx_hal_msp.c
    new file:   Core/Src/stm32f3xx_it.c
    new file:   Core/Src/syscalls.c
    new file:   Core/Src/sysmem.c
    new file:   Core/Src/system_stm32f3xx.c
    new file:   Core/Startup/startup_stm32f303vctx.s
    new file:   Drivers/CMSIS/Device/ST/STM32F3xx/Include/stm32f303xc.h
    new file:   Drivers/CMSIS/Device/ST/STM32F3xx/Include/stm32f3xx.h
    new file:   Drivers/CMSIS/Device/ST/STM32F3xx/Include/system_stm32f3xx.h
    new file:   Drivers/CMSIS/Include/cmsis_armcc.h
    new file:   Drivers/CMSIS/Include/cmsis_armclang.h
    new file:   Drivers/CMSIS/Include/cmsis_compiler.h
    new file:   Drivers/CMSIS/Include/cmsis_gcc.h
    new file:   Drivers/CMSIS/Include/cmsis_iccarm.h
    new file:   Drivers/CMSIS/Include/cmsis_version.h
    new file:   Drivers/CMSIS/Include/core_armv8mbl.h
    new file:   Drivers/CMSIS/Include/core_armv8mml.h
    new file:   Drivers/CMSIS/Include/core_cm0.h
    new file:   Drivers/CMSIS/Include/core_cm0plus.h
    new file:   Drivers/CMSIS/Include/core_cm1.h
    new file:   Drivers/CMSIS/Include/core_cm23.h
    new file:   Drivers/CMSIS/Include/core_cm3.h
    new file:   Drivers/CMSIS/Include/core_cm33.h
    new file:   Drivers/CMSIS/Include/core_cm4.h
    new file:   Drivers/CMSIS/Include/core_cm7.h
    new file:   Drivers/CMSIS/Include/core_sc000.h
    new file:   Drivers/CMSIS/Include/core_sc300.h
    new file:   Drivers/CMSIS/Include/mpu_armv7.h
    new file:   Drivers/CMSIS/Include/mpu_armv8.h
    new file:   Drivers/CMSIS/Include/tz_context.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/Legacy/stm32_hal_legacy.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_cortex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_def.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_dma.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_dma_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_exti.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_flash.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_flash_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_gpio.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_gpio_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_i2c.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_i2c_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_pcd.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_pcd_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_pwr.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_pwr_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_rcc.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_rcc_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_spi.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_spi_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_tim.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_tim_ex.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_ll_usb.h
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_cortex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_dma.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_exti.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_flash.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_flash_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_gpio.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_i2c.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_i2c_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_pcd.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_pcd_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_pwr.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_pwr_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_rcc.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_rcc_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_spi.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_spi_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_tim.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_hal_tim_ex.c
    new file:   Drivers/STM32F3xx_HAL_Driver/Src/stm32f3xx_ll_usb.c
    new file:   STM32F303VCTX_FLASH.ld
    new file:   TestSD.ioc
    new file:   readme.txt

git commit -m "initial state"

    STM32CubeMX - TestSD.ioc - Pinout&Configuration
	Middleware - FREERTOS 
	    Mode - Interface=CMSIS_V2
	    Configuration - Config Parameters
		TOTAL_HEAP_SIZE=8000
	Middleware - FATFS
	    Mode - User Defined

    при сохранении получил окно WARNINGS:
- When FreeRTOS is used? it is strogly recommended to use a HAL timebase source other than the Systick...

    STM32CubeMX - TestSD.ioc - Pinout&Configuration
	System Core - SYS
	    Timebase Source=TIM1

git add -A
git commit -m "добавлены FREERTOS, FATFS"
[master 15328b8] добавлены FREERTOS, FATFS
 56 files changed, 35621 insertions(+), 94 deletions(-)
...

    STM32CubeMX - TestSD.ioc - Pinout&Configuration
	Connectivity - SPI2
	    Mode=Full-Duplex Master


Wed 15 Apr 2020 04:16:16 PM MSK
    добавил мигание LED5
    compile - load - debug = OK

git add -A
    добавилось много ненужных файлов
git reset HEAD
    скопировал .gitignore из пред.проекта

Thu 16 Apr 2020 02:04:02 PM MSK
    поменял прескалер=16 ==> BaudRate=1.5 Mb/s

Sat 18 Apr 2020 03:22:01 PM MSK
    добавил задачи Обработка нажатия клавиши и Тестирование SPI
    добавил EventFlags с одним флагом - выполнить тест SPI = EF_SPI_SEND_TEST_CMD
    добавил диагностику создания EventFlags - частотой мигания LD4 (если часто - ошибка)
    по нажатию кнопки гашу индицирующие LD7 LD8
    по отпусканию кнопки ставлю в spi_event_flags флаг EF_SPI_SEND_TEST_CMD,
	а по нему в другой задаче делаю HAL_SPI_TransmitReceive
    соединяю проводом ноги PB14 - PB15
	и посылаю 0,1,2... в SPI2 и тут же принимаю 
	сравниваю - если == - зажигаю LD8
    РАБОТАЕТ!!! Но до 16ти нажатий - дальше несовпадение, т.к. Data Size = 4 Bits
